{{ self.title() }}


## {{ _('Description') }}

众所周知，小葱同学擅长计算，尤其擅长计算组合数，但这题不仅和组合数没什么关系，甚至和小葱也没有关系。

这次我们的主人公是小何同学。众所周知，小何同学非常有钱，他买了 $K$ 台TPU来解决A+B问题。现在小何同学有 $N$ 个A+B问题，第 $i$ 个A+B问题在 第 $j$ 台TPU上计算需要 $t_{ij}$ 的时间。与传统的A+B问题不一样的是，这 $N$ 个A+B问题之间有 $M$ 个依赖关系，如果问题 $i$ 依赖于 问题 $j$，那么问题 $i$ 必须等待问题 $j$ 计算完毕，并将计算的结果传输给问题 $j$ 之后，问题 $j$ 才能开始进行计算。如果问题 $i$ 在第 $p$ 台TPU上进行计算，问题 $j$ 在第 $q$ 台机器上进行计算，那么问题 $i$ 的结果传输到问题 $j$ 所需要的时间为 $r_{pq}$。数据之间的传输是并行的，即如果同时有多台机器向一台机器传输数据，并不会影响到数据传输的速度；但我们规定数据的传输是不能转发的，即如果要从第 $i$ 台机器向第 $j$ 台机器传输某个数据，不能先传输到第 $k$ 台机器再传输到第 $j$ 台机器。

虽然小何同学特别有钱，但是小何同学没有多少的时间毕竟他还要去陪妹子，所以现在小何同学希望你来帮他决定每个A+B问题分配到哪台机器上计算，使得所有TPU的计算时间总和最小或者所有任务完成的时间最小。所谓TPU的计算时间，其定义为TPU用来计算问题的时间，即在等待数据传输的时间是不计入计算时间的。

虽然小何同学特别有钱，并且小何同学知道你也没有多少时间来做这个题，所以小何同学为了简化问题，对上述任务作出了如下规定：

1、问题的依赖关系之间没有环。

2、任何一个时刻，一台TPU只能计算一个问题，且一旦开始这个问题的计算，就不会被打断，会一直计算到这个问题计算完成。

3、如果一台TPU此时没有计算任何一个问题，并且存在一个或多个问题已经准备好数据可以计算，那么TPU会选择其中编号最小的问题开始计算。

4、一台TPU同时进行多个数据传输，且彼此之间互相不会影响速度，计算问题的同时也可以进行数据传输，且彼此之间的速度都不会受到影响。

5、数据不能进行转发，只能直接在相应的机器之间传输。

6、保证 $r_{ii}=0$。

在上面的这些条件下，小何同学认为这个问题已经足够简单了，于是他愉快地去找妹子玩耍，并把这个问题交给了你。


## {{ _('Input Format') }}

{{ self.input_file() }}


第一行两个整数 $N,M,K$。

接下来 $M$ 行每行两个数 $i,j$，代表问题 $j$ 依赖于 问题 $i$。

接下来 $N$ 行每行 $K$ 个数，代表 $t_{ij}$。

接下来 $K$ 行每行 $K$ 个数，代表 $r_{ij}$。


## {{ _('Output Format') }}

{{ self.output_file() }}

一行 $N$ 个整数，代表每个任务被分配给哪台机器。

{% set vars = {} -%}
{%- do vars.__setitem__('sample_id', 1) -%}
{{ self.sample_text() }}


## {{ _('Subtasks') }}

对于 $20\%$ 的数据，$n\leq 10$。

对于 $40\%$ 的数据，$n\leq 500$。

对于另外 $20\%$ 的数据，$k=1$。

对于 $100\%$ 的数据， $1\leq n\leq 10^6,1\leq k\leq 10^5$。


